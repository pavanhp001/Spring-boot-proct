
  
 
ALTER TABLE  CM_PAY_EVT DROP CONSTRAINT FK_CM_PAY_EVT_CONSUMER;
DROP SEQUENCE  CM_PAY_EVT_SEQ;
DROP   INDEX  IDX_CM_PAY_EVT_CUST;
DROP   INDEX  IDX_CM_PAY_EVT_CUST_EXTID;
DROP TABLE  CM_PAY_EVT ;
  
CREATE SEQUENCE  CM_PAY_EVT_SEQ
    INCREMENT BY 1
    START WITH 1
    NOMAXVALUE
    NOMINVALUE
    NOCYCLE
    CACHE 20
    NOORDER;


CREATE TABLE  CM_PAY_EVT ( 
    ID            	NUMBER(19,0) NOT NULL, 
    EXTERNAL_ID   	NUMBER(19,0)  NOT NULL, 
 	CVV   			VARCHAR2(60) NOT NULL,
 	CURRENCY   		VARCHAR2(60) NOT NULL,
 	CONFIRM_NUM   	VARCHAR2(60) NOT NULL,
 	PAY_STATUS   	VARCHAR2(60) NOT NULL,
 	ORDER_EXT_ID   	NUMBER(19,0),
 	LI_EXT_ID   	NUMBER(19,0),
	IS_DISCLOSURE   NUMBER(9),
	PAY_EVT_TYPE   	VARCHAR2(60) NOT NULL,
    BILL_INFO_ID   	NUMBER(19,0) NOT NULL,
    CONSUMER_ID   	NUMBER(19,0) NOT NULL,
    TRANS_DATE      DATE  NOT NULL,
    PRIMARY KEY(ID)
);
 


ALTER TABLE  CM_PAY_EVT
    ADD ( CONSTRAINT FK_CM_PAY_EVT_CM
	FOREIGN KEY(CONSUMER_ID)
	REFERENCES V_TX.CM_CONSUMER(CONSUMER_ID)
	ON DELETE SET NULL NOT DEFERRABLE INITIALLY IMMEDIATE VALIDATE )
;
 
CREATE   INDEX  IDX_CM_PAY_EVT_CUST ON  CM_PAY_EVT(CONSUMER_ID);
CREATE   INDEX  IDX_CM_PAY_EVT_EXT_ID ON  CM_PAY_EVT(EXTERNAL_ID);
CREATE   INDEX  IDX_CM_PAY_EVT_FULL ON  CM_PAY_EVT(CONSUMER_ID,ORDER_EXT_ID,LI_EXT_ID);

	